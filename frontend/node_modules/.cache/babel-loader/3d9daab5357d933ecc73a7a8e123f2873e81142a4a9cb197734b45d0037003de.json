{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import Annotation from'react-image-annotation';import'../components/css/styles.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AnnotationScreen=()=>{const[task,setTask]=useState(null);const[annotations,setAnnotations]=useState([]);const[annotation,setAnnotation]=useState({});const[loading,setLoading]=useState(false);const[error,setError]=useState('');const fetchTask=()=>{setLoading(true);axios.get('http://localhost:5000/get-task').then(res=>setTask(res.data.task)).catch(()=>{setTask(null);// Clear task if fetch fails\nsetError('Failed to load task. Please try again later.');}).finally(()=>setLoading(false));};useEffect(()=>{fetchTask();},[]);const saveAnnotations=()=>{if(annotations.length===0){alert(\"Please add some annotations first.\");return;}setLoading(true);axios.post('http://localhost:5000/submit-annotation',{task_id:task._id,// Fixed key for MongoDB documents\nannotations}).then(()=>{alert('Annotations saved!');setAnnotations([]);}).catch(()=>alert('Failed to save annotations. Please try again.')).finally(()=>setLoading(false));};if(loading)return/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"});return/*#__PURE__*/_jsx(\"div\",{className:\"annotation-container\",children:error?/*#__PURE__*/_jsx(\"p\",{children:error}):task?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Annotation,{src:task.image_url,annotations:annotations,value:annotation,onChange:setAnnotation,onSubmit:newAnnotation=>{setAnnotations([...annotations,newAnnotation]);setAnnotation({});}}),/*#__PURE__*/_jsx(\"button\",{onClick:saveAnnotations,className:\"save-btn\",children:\"Save\"})]}):/*#__PURE__*/_jsx(\"p\",{children:\"No tasks available.\"})});};export default AnnotationScreen;","map":{"version":3,"names":["React","useState","useEffect","axios","Annotation","jsx","_jsx","jsxs","_jsxs","AnnotationScreen","task","setTask","annotations","setAnnotations","annotation","setAnnotation","loading","setLoading","error","setError","fetchTask","get","then","res","data","catch","finally","saveAnnotations","length","alert","post","task_id","_id","children","className","src","image_url","value","onChange","onSubmit","newAnnotation","onClick"],"sources":["C:/Users/CHAOS/Documents/GitHub/labelbox-web-app/frontend/src/components/AnnotationScreen.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport Annotation from 'react-image-annotation';\r\nimport '../components/css/styles.css';\r\n\r\nconst AnnotationScreen = () => {\r\n    const [task, setTask] = useState(null);\r\n    const [annotations, setAnnotations] = useState([]);\r\n    const [annotation, setAnnotation] = useState({});\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState('');\r\n\r\n    const fetchTask = () => {\r\n        setLoading(true);\r\n        axios.get('http://localhost:5000/get-task')\r\n            .then((res) => setTask(res.data.task))\r\n            .catch(() => {\r\n                setTask(null); // Clear task if fetch fails\r\n                setError('Failed to load task. Please try again later.');\r\n            })\r\n            .finally(() => setLoading(false));\r\n    };    \r\n\r\n    useEffect(() => {\r\n        fetchTask();\r\n    }, []);\r\n\r\n    const saveAnnotations = () => {\r\n        if (annotations.length === 0) {\r\n            alert(\"Please add some annotations first.\");\r\n            return;\r\n        }\r\n        setLoading(true);\r\n        axios.post('http://localhost:5000/submit-annotation', {\r\n            task_id: task._id, // Fixed key for MongoDB documents\r\n            annotations\r\n        })\r\n        .then(() => {\r\n            alert('Annotations saved!');\r\n            setAnnotations([]);\r\n        })\r\n        .catch(() => alert('Failed to save annotations. Please try again.'))\r\n        .finally(() => setLoading(false));\r\n    };\r\n\r\n    if (loading) return <p>Loading...</p>;\r\n\r\n    return (\r\n        <div className=\"annotation-container\">\r\n            {error ? (\r\n                <p>{error}</p>\r\n            ) : task ? (\r\n                <div>\r\n                    <Annotation\r\n                        src={task.image_url}\r\n                        annotations={annotations}\r\n                        value={annotation}\r\n                        onChange={setAnnotation}\r\n                        onSubmit={(newAnnotation) => {\r\n                            setAnnotations([...annotations, newAnnotation]);\r\n                            setAnnotation({});\r\n                        }}\r\n                    />\r\n                    <button onClick={saveAnnotations} className=\"save-btn\">\r\n                        Save\r\n                    </button>\r\n                </div>\r\n            ) : (\r\n                <p>No tasks available.</p>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AnnotationScreen;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}